(function(e){function t(t){for(var r,i,o=t[0],u=t[1],c=t[2],p=0,d=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},s=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/gitlab-runner-ctrl/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("003e")},e76a:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("link",{attrs:{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css",integrity:"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T",crossorigin:"anonymous"}}),n("div",{staticClass:"container-fluid"},[n("h1",[e._v("GitLab Runner Control")]),n("h2",{on:{click:function(t){e.foldConfig=!e.foldConfig}}},[e._v("Config")]),e.foldConfig?e._e():n("table",{staticClass:"table"},[n("tr",[n("td",[e._v("GitLab URL")]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.gitlabUrl,expression:"gitlabUrl"}],staticClass:"form-control",domProps:{value:e.gitlabUrl},on:{input:function(t){t.target.composing||(e.gitlabUrl=t.target.value)}}})])]),n("tr",[n("td",[e._v("Access Token")]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.personalAccessToken,expression:"personalAccessToken"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:e.personalAccessToken},on:{input:function(t){t.target.composing||(e.personalAccessToken=t.target.value)}}})])]),n("tr",[n("td"),n("td",[n("button",{staticClass:"btn btn-primary float-right",on:{click:e.saveConfig}},[e._v("Save")])])])]),n("h2",{on:{click:function(t){e.foldRunners=!e.foldRunners}}},[e._v("Runners")]),e.foldRunners?e._e():[n("div",{staticClass:"row"},[n("div",{staticClass:"col-12 my-2"},[n("button",{staticClass:"btn btn-secondary mr-2",on:{click:e.downloadRunners}},[e._v("Reload")]),n("button",{staticClass:"btn btn-primary mr-2",on:{click:e.activateMatchedRunners}},[e._v("Activate following runners")]),n("button",{staticClass:"btn btn-danger mr-2",on:{click:e.pauseMatchedRunners}},[e._v("Pause following runners")])]),n("div",{staticClass:"col-6 my-2"},[n("div",{staticClass:"input-group mb-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.tagAdd,expression:"tagAdd"}],staticClass:"form-control",attrs:{placeholder:"tag name"},domProps:{value:e.tagAdd},on:{input:function(t){t.target.composing||(e.tagAdd=t.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-primary",attrs:{disabled:0==e.tagAdd.length},on:{click:e.addTagToMatchedRunners}},[e._v("Add tag")])])])]),n("div",{staticClass:"col-6 my-2"},[n("div",{staticClass:"input-group mb-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.tagRemove,expression:"tagRemove"}],staticClass:"form-control",attrs:{placeholder:"tag name"},domProps:{value:e.tagRemove},on:{input:function(t){t.target.composing||(e.tagRemove=t.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-danger",attrs:{disabled:0==e.tagRemove.length},on:{click:e.removeTagFromMatchedRunners}},[e._v("Remove tag")])])])])]),n("table",{staticClass:"table"},[n("thead",[e._m(0),n("tr",[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.descriptionRegexp,expression:"descriptionRegexp"}],staticClass:"form-control",attrs:{placeholder:"filter by description"},domProps:{value:e.descriptionRegexp},on:{input:function(t){t.target.composing||(e.descriptionRegexp=t.target.value)}}})]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.statusRegexp,expression:"statusRegexp"}],staticClass:"form-control",attrs:{placeholder:"filter by status"},domProps:{value:e.statusRegexp},on:{input:function(t){t.target.composing||(e.statusRegexp=t.target.value)}}})]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.tagRegexp,expression:"tagRegexp"}],staticClass:"form-control",attrs:{placeholder:"filter by tags"},domProps:{value:e.tagRegexp},on:{input:function(t){t.target.composing||(e.tagRegexp=t.target.value)}}})]),n("td")])]),n("tbody",e._l(e.matchedRunners,function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.description))]),n("td",[e._v(e._s(t.status))]),n("td",[t.id in e.runnerDetails?e._l(e.runnerDetails[t.id].tag_list,function(t){return n("span",{key:t,staticStyle:{margin:"0px 3px"},domProps:{textContent:e._s(t)}})}):e._e()],2),n("td",[e._v(e._s(t.id in e.runnerJobs?e.runnerJobs[t.id].length:"?"))])])}),0)])],n("h2",{on:{click:function(t){e.foldJobs=!e.foldJobs}}},[e._v("Jobs")]),e.foldJobs?e._e():[n("div",{staticClass:"row"},[n("div",{staticClass:"col-12 my-2"},[n("button",{staticClass:"btn btn-secondary mr-2",on:{click:e.downloadRunners}},[e._v("Reload")])])]),n("table",{staticClass:"table"},[e._m(1),n("tbody",[e._l(e.runnerJobs,function(t,r){return e._l(t,function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(e.runnerDetails[r].description))]),n("td",[n("a",{attrs:{href:t.pipeline.web_url}},[e._v("#"+e._s(t.pipeline.id))])]),n("td",[n("a",{attrs:{href:t.web_url}},[e._v(e._s(t.name))])]),n("td",[e._v(e._s(t.duration))]),n("td",[n("button",{staticClass:"btn btn-danger",on:{click:function(n){return e.cancelJob(t.project.id,t.id)}}},[e._v("Cancel")])])])})})],2)])]],2)])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("th",[e._v("Description")]),n("th",[e._v("Status")]),n("th",[e._v("Tags")]),n("th",[e._v("Running Jobs")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("Runner")]),n("th",[e._v("Pipeline")]),n("th",[e._v("Job Name")]),n("th",[e._v("Duration")]),n("th",[e._v("Operation")])])])}],s=n("9873"),i=(n("c333"),n("14ca"),n("5135"),n("09d3"),n("63f4"),n("6c56"),n("b957"),n("35f5"),n("221a"),n("3514")),o=(n("5621"),n("e997"),{name:"app",data:function(){return{personalAccessToken:"",gitlabUrl:"",descriptionRegexp:"",statusRegexp:"",tagRegexp:"",tagAdd:"",tagRemove:"",runners:[],runnerDetails:{},runnerJobs:{},foldConfig:!0,foldRunners:!1,foldJobs:!1}},computed:{matchedRunners:function(){var e=this,t=new RegExp(this.descriptionRegexp),n=new RegExp(this.statusRegexp),r=new RegExp(this.tagRegexp),a=this.runners;return a=a.filter(function(e){return t.test(e.description)}),a=a.filter(function(e){return n.test(e.status)}),a=a.filter(function(t){return!(t.id in e.runnerDetails)||r.test(e.runnerDetails[t.id].tag_list.join(" "))}),a}},created:function(){this.loadCache()},methods:{loadCache:function(){this.runners=JSON.parse(localStorage.getItem("runners")||"[]"),this.runnerDetails=JSON.parse(localStorage.getItem("runnerDetails")||"{}"),this.runnerJobs=JSON.parse(localStorage.getItem("runnerJobs")||"{}"),this.personalAccessToken=localStorage.getItem("personalAccessToken"),this.gitlabUrl=localStorage.getItem("gitlabUrl")},saveConfig:function(){localStorage.setItem("personalAccessToken",this.personalAccessToken),localStorage.setItem("gitlabUrl",this.gitlabUrl)},getAll:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){var r,a,s,i,o,u,c,l,p,d,f=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(a=f.length>2&&void 0!==f[2]?f[2]:{},s=new URLSearchParams,s.set("per_page",100),i=0,o=Object.keys(a);i<o.length;i++)u=o[i],s.set(u,a[u]);c=[],l=1;case 6:if(!l){e.next=18;break}return s.set("page",l),e.next=10,fetch(t+"?"+s.toString(),n);case 10:return p=e.sent,e.next=13,p.json();case 13:d=e.sent,c.push(d),l=p.headers.get("X-Next-Page"),e.next=6;break;case 18:return e.abrupt("return",(r=[]).concat.apply(r,c));case 19:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),downloadRunners:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAll("".concat(this.gitlabUrl,"/api/v4/runners/all"),{headers:{"PRIVATE-TOKEN":this.personalAccessToken}});case 2:t=e.sent,localStorage.setItem("runners",JSON.stringify(t)),this.runners=t,this.downloadRunnerDetails(),this.downloadRunnerJobs();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),downloadRunnerDetails:function(){var e=this;this.runnerDetails={};var t=[],n=!0,r=!1,a=void 0;try{for(var s,i=function(){var n=s.value;t.push(e.getRunner(n.id).then(function(t){e.$set(e.runnerDetails,n.id,t)}))},o=this.runners[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)i()}catch(u){r=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}Promise.all(t).then(function(){localStorage.setItem("runnerDetails",JSON.stringify(e.runnerDetails))})},downloadRunnerJobs:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,s,i,o,u=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(this.runnerJobs={},t=[],n=!0,r=!1,a=void 0,e.prev=5,s=function(){var e=o.value;t.push(u.getJobs(e.id).then(function(t){u.$set(u.runnerJobs,e.id,t)}))},i=this.runners[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)s();e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](5),r=!0,a=e.t0;case 14:e.prev=14,e.prev=15,n||null==i.return||i.return();case 17:if(e.prev=17,!r){e.next=20;break}throw a;case 20:return e.finish(17);case 21:return e.finish(14);case 22:Promise.all(t).then(function(){localStorage.setItem("runnerJobs",JSON.stringify(u.runnerJobs))});case 23:case"end":return e.stop()}},e,this,[[5,10,14,22],[15,,17,21]])}));function t(){return e.apply(this,arguments)}return t}(),pauseMatchedRunners:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(confirm("Really stop them?")){e.next=2;break}return e.abrupt("return");case 2:t=!0,n=!1,r=void 0,e.prev=5,a=this.matchedRunners[Symbol.iterator]();case 7:if(t=(s=a.next()).done){e.next=14;break}return i=s.value,e.next=11,this.updateRunner(i.id,{active:!1});case 11:t=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](5),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,t||null==a.return||a.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",this.downloadRunners());case 29:case"end":return e.stop()}},e,this,[[5,16,20,28],[21,,23,27]])}));function t(){return e.apply(this,arguments)}return t}(),activateMatchedRunners:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,a,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(confirm("Really activate them?")){e.next=2;break}return e.abrupt("return");case 2:t=!0,n=!1,r=void 0,e.prev=5,a=this.matchedRunners[Symbol.iterator]();case 7:if(t=(s=a.next()).done){e.next=14;break}return i=s.value,e.next=11,this.updateRunner(i.id,{active:!0});case 11:t=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](5),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,t||null==a.return||a.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",this.downloadRunners());case 29:case"end":return e.stop()}},e,this,[[5,16,20,28],[21,,23,27]])}));function t(){return e.apply(this,arguments)}return t}(),addTagToMatchedRunners:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!=this.tagAdd.length){e.next=2;break}return e.abrupt("return");case 2:if(confirm("Add tag: ".concat(this.tagAdd," to them?"))){e.next=4;break}return e.abrupt("return");case 4:return t=this.matchedRunners.filter(function(e){return e.id in n.runnerDetails}),e.next=7,Promise.all(t.map(function(e){var t;return n.updateRunner(e.id,{tag_list:(t=[]).concat.apply(t,[n.tagAdd].concat(Object(s["a"])(n.runnerDetails[e.id].tag_list)))})}));case 7:return e.abrupt("return",this.downloadRunners());case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),removeTagFromMatchedRunners:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!=this.tagRemove.length){e.next=2;break}return e.abrupt("return");case 2:if(confirm("Remove tag: ".concat(this.tagRemove," from them?"))){e.next=4;break}return e.abrupt("return");case 4:return t=this.matchedRunners.filter(function(e){return e.id in n.runnerDetails}),e.next=7,Promise.all(t.map(function(e){return n.updateRunner(e.id,{tag_list:n.runnerDetails[e.id].tag_list.filter(function(e){return e!=n.tagRemove})})}));case 7:return e.abrupt("return",this.downloadRunners());case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),cancelJob:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(confirm("Cancel job?")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("".concat(this.gitlabUrl,"/api/v4/projects/").concat(t,"/jobs/").concat(n,"/cancel"),{method:"POST",headers:{"PRIVATE-TOKEN":this.personalAccessToken}});case 4:return e.abrupt("return",this.downloadRunners());case 5:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),updateRunner:function(e,t){return fetch("".concat(this.gitlabUrl,"/api/v4/runners/").concat(e),{method:"PUT",body:JSON.stringify(t),headers:{"PRIVATE-TOKEN":this.personalAccessToken,"Content-Type":"application/json"}}).then(function(e){return e.json()})},getRunner:function(e){return fetch("".concat(this.gitlabUrl,"/api/v4/runners/").concat(e),{headers:{"PRIVATE-TOKEN":this.personalAccessToken}}).then(function(e){return e.json()})},getJobs:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"running";return this.getAll("".concat(this.gitlabUrl,"/api/v4/runners/").concat(e,"/jobs"),{headers:{"PRIVATE-TOKEN":this.personalAccessToken}},{status:t})}}}),u=o,c=n("d9a4"),l=Object(c["a"])(u,r,a,!1,null,null,null);t["a"]=l.exports}});
//# sourceMappingURL=app.cfe3a843.js.map